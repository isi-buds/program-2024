---
title: "logistic_regression_example"
format: html
editor: visual
---

## Libraries

```{r}
library(tidyverse)
```

## Data

A retrospective sample of males in a heart-disease high-risk region of the Western Cape, South Africa.
There are roughly two controls per case of CHD.
Many of the CHD positive men have undergone blood pressure reduction treatment and other programs to reduce their risk factors after their CHD event.
In some cases the measurements were made after these treatments.
These data are taken from a larger dataset, described in Rousseauw et al, 1983, South African Medical Journal.

sbp systolic blood pressure tobacco cumulative tobacco (kg) ldl low densiity lipoprotein cholesterol adiposity famhist family history of heart disease (Present, Absent) typea type-A behavior obesity alcohol current alcohol consumption age age at onset chd response, coronary heart disease

```{r}
heart_data = read.table("https://hastie.su.domains/ElemStatLearn/datasets/SAheart.data",
	sep=",",head=T,row.names=1)
```

## one covariate

```{r}
model1 = glm(chd ~ tobacco, family = "binomial", data = heart_data)

summary(model1)
```

## Interpretation of parameter

For two populations of men who differ in cumulative tobacco consumption by 1 kilogram, the log odds ratio 9s 1.4527.

The odds ratio is e\^{1.4427} = 4.232107, i.e. the odds are four times larger for the population which smokes an additional kilogram of tobacco.

## Confidence interval

```{r}
exp(1.4427 - 1.96 * 0.02476)
exp(1.4427 + 1.96 * 0.02476)
```

A plaussible frange for the odds ratio is 4.03 to 4.44.

## more than one parameter

```{r}
model2 = glm(chd ~ tobacco + alcohol + famhist + ldl, family = "binomial", data = heart_data)

summary(model2)
```

## showing the fitted values of the model

```{r}
fitted_vals = model2$fitted.values

plot(fitted_vals)

range(fitted_vals)
```
